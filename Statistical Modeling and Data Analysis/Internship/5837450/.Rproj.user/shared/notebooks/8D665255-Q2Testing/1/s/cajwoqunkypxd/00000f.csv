"0","age_groups <- c(""0-24"", ""25-34"", ""35-44"", ""45-54"", ""55-64"", ""65-74"", ""75-84"", ""85+"")"
"0",""
"0","for (age_group in age_groups) {"
"0","  data_age_group <- month_matrices_by_age[[age_group]]"
"0",""
"0","  # calculate the total number of deaths for each month"
"0","  monthly_deaths <- rowSums(data_age_group)"
"0",""
"0","  # define the bin boundaries"
"0","  breaks <- pretty(monthly_deaths, n = 5)"
"0",""
"0","  # group the data into bins"
"0","  monthly_deaths_binned <- cut(monthly_deaths, breaks = breaks, dig.lab = 5)"
"0",""
"0","  # Extract the levels of the monthly_deaths_binned factor variable"
"0","  bin_levels <- levels(monthly_deaths_binned)"
"0",""
"0","  # count the number of occurrences of each outcome"
"0","  counts <- table(monthly_deaths_binned)"
"0",""
"0","  # calculate the probabilities for each outcome"
"0","  prob <- counts / sum(counts)"
"0",""
"0","  # create a data frame with the outcomes and probabilities"
"0","  data_pmf <- data.frame(deaths = names(prob), prob)"
"0",""
"0","  data_pmf$deaths <- factor(data_pmf$deaths, levels = bin_levels)"
"0",""
"0","  # plot the PMF using ggplot2"
"0","  p <- ggplot(data_pmf, aes(deaths, prob)) +"
"0","    geom_bar(stat = ""identity"", color = ""black"", fill = ""white"", width = 0.9) +"
"0","    scale_x_discrete(labels = function(x) format(x, scientific = FALSE)) +"
"0","    ggtitle(paste0(""PMF Plot for Age Group "", age_group)) +"
"0","    xlab(""Monthly Deaths (binned)"") +"
"0","    ylab(""P(X = x)"")"
"0",""
"0","  print(p)"
"0","}"
"0",""
